

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Setting up a new computer &mdash; Environment setups  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="How to edit these docs" href="rest.html" />
    <link rel="prev" title="Set-ups, shell environments, installations" href="index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Environment setups
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Docs</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Setting up a new computer</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#obtain-a-usb-drive-with-ubuntu">Obtain a USB drive with Ubuntu</a></li>
<li class="toctree-l2"><a class="reference internal" href="#install-ubuntu-and-drivers">Install Ubuntu and drivers</a></li>
<li class="toctree-l2"><a class="reference internal" href="#updates">Updates</a></li>
<li class="toctree-l2"><a class="reference internal" href="#reconfiguring-grub-and-the-display-server">Reconfiguring grub and the display server</a></li>
<li class="toctree-l2"><a class="reference internal" href="#configure-ssh">Configure SSH</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#ssh-keys">SSH keys</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#store">Store</a></li>
<li class="toctree-l2"><a class="reference internal" href="#checkinstall">Checkinstall</a></li>
<li class="toctree-l2"><a class="reference internal" href="#shared-bashrcs">Shared .bashrcs</a></li>
<li class="toctree-l2"><a class="reference internal" href="#environment-modules">Environment modules</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#installation">Installation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#sourcing-modules">Sourcing modules</a></li>
<li class="toctree-l3"><a class="reference internal" href="#modulefiles">Modulefiles</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#anaconda">Anaconda</a></li>
<li class="toctree-l2"><a class="reference internal" href="#gcc">GCC</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id1">Installation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#switching-between-versions">Switching between versions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#cuda">CUDA</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#cuda-8">CUDA 8</a></li>
<li class="toctree-l3"><a class="reference internal" href="#cuda-9">CUDA 9</a></li>
<li class="toctree-l3"><a class="reference internal" href="#cuda-10">CUDA 10</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#gromacs">GROMACS</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id2">2016.1</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id3">2018.3</a></li>
<li class="toctree-l3"><a class="reference internal" href="#other-versions">Other versions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#g-mydensity-4-5-7">g_mydensity (4.5.7)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#install-fftw-3">Install fftw-3</a></li>
<li class="toctree-l4"><a class="reference internal" href="#gromacs-4-5-7">GROMACS 4.5.7</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id4">g_mydensity</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#amber">AMBER</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#ambertools-19">AmberTools 19</a></li>
<li class="toctree-l3"><a class="reference internal" href="#amber-16">Amber 16</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#cuda-and-gfortran">CUDA and gfortran</a></li>
<li class="toctree-l4"><a class="reference internal" href="#dependencies">Dependencies</a></li>
<li class="toctree-l4"><a class="reference internal" href="#install">Install</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#autodock-tools-and-vina">Autodock Tools and Vina</a></li>
<li class="toctree-l2"><a class="reference internal" href="#pymol">PyMol</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#apt">apt</a></li>
<li class="toctree-l3"><a class="reference internal" href="#building-from-source">Building from source</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="rest.html">How to edit these docs</a></li>
<li class="toctree-l1"><a class="reference internal" href="customise_environment.html">Customising your environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="MemSurfer.html">Making MemSurfer Work</a></li>
<li class="toctree-l1"><a class="reference internal" href="FATSLiM.html">Installing FATSLiM</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Environment setups</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Setting up a new computer</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/new_computer.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="setting-up-a-new-computer">
<span id="new-computer-label"></span><h1>Setting up a new computer<a class="headerlink" href="#setting-up-a-new-computer" title="Permalink to this headline">¶</a></h1>
<div class="section" id="obtain-a-usb-drive-with-ubuntu">
<h2>Obtain a USB drive with Ubuntu<a class="headerlink" href="#obtain-a-usb-drive-with-ubuntu" title="Permalink to this headline">¶</a></h2>
<p>You need to somehow create a bootable USB stick. This is easiest in Ubuntu and there are many tutorials already, so I won’t clutter it up. (Katie has one).</p>
</div>
<div class="section" id="install-ubuntu-and-drivers">
<h2>Install Ubuntu and drivers<a class="headerlink" href="#install-ubuntu-and-drivers" title="Permalink to this headline">¶</a></h2>
<p>Stick the USB in and boot up the computer. You need to change the boot order to boot off the USB stick first. This differs across operating systems; on our old Ubuntu 16.04s, we hit F10 to bring up Boot Options.</p>
<p>You can choose a normal installation or a minimal one. Out of convenience, we go with the normal installation; the only weirdly irritating thing it installs is Amazon. This shouldn’t take long – ours was under 10 min.</p>
<p>The computer will reboot after this.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If your screen flickers and dies, this is due to the graphics drivers not working properly. Go into Advanced Options and boot into Recovery mode.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><strong>Do not reboot before updating drivers and setting up SSH.</strong></p>
</div>
</div>
<div class="section" id="updates">
<h2>Updates<a class="headerlink" href="#updates" title="Permalink to this headline">¶</a></h2>
<p>Most of these should already be installed; check anyway.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo apt update
sudo ubuntu-drivers autoinstall
sudo apt install build-essential
sudo apt install linux-headers-<span class="k">$(</span>uname -r<span class="k">)</span>
sudo apt install vim git net-tools openssh-server checkinstall
</pre></div>
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>This will install NVIDIA drivers. Check that it is working with <code class="docutils literal notranslate"><span class="pre">nvidia-smi</span></code>. If you see a table of performance numbers, all is well. If a message comes up that <code class="docutils literal notranslate"><span class="pre">nvidia-smi</span></code> cannot communicate with your card, you likely have Safe Boot on. Safe Boot does not allow third-party drivers; NVIDIA is a third party. Disable Safe Boot by typing:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo mokutil --disable-validation
</pre></div>
</div>
<p>It will ask you for a password. When you reboot, a blue screen will show up. This is the MOK management screen. Press any key to perform MOK management and select <span class="menuselection">Change Secure Boot state</span>. It will ask you password questions.</p>
<p>Alternatively, you can sign modules yourself.</p>
</div>
</div>
<div class="section" id="reconfiguring-grub-and-the-display-server">
<h2>Reconfiguring grub and the display server<a class="headerlink" href="#reconfiguring-grub-and-the-display-server" title="Permalink to this headline">¶</a></h2>
<p>Edit <code class="docutils literal notranslate"><span class="pre">/etc/gdm3/custom.conf</span></code>. Uncomment:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># WaylandEnable=false</span>
</pre></div>
</div>
<p>This forces the computer to use the Xorg display server.</p>
<p>Then edit <code class="docutils literal notranslate"><span class="pre">/etc/default/grub</span></code>. Replace:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">GRUB_CMDLINE_LINUX_DEFAULT</span><span class="o">=</span><span class="s2">&quot;quiet splash&quot;</span>
</pre></div>
</div>
<p>with:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">GRUB_CMDLINE_LINUX_DEFAULT</span><span class="o">=</span><span class="s2">&quot;quiet splash nomodeset&quot;</span>
</pre></div>
</div>
<p>This will disable video drivers until the kernel has started. Update with:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo update-grub
</pre></div>
</div>
</div>
<div class="section" id="configure-ssh">
<h2>Configure SSH<a class="headerlink" href="#configure-ssh" title="Permalink to this headline">¶</a></h2>
<p>You should have installed <code class="docutils literal notranslate"><span class="pre">openssh-server</span></code> above. Enable the service and start it.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo systemctl <span class="nb">enable</span> ssh
sudo systemctl start ssh
</pre></div>
</div>
<p>Test your access by ssh-ing in. To set up a firewall, first check that the line below is in <code class="docutils literal notranslate"><span class="pre">/etc/default/ufw</span></code>.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">IPV6</span><span class="o">=</span>yes
</pre></div>
</div>
<div class="section" id="ssh-keys">
<h3>SSH keys<a class="headerlink" href="#ssh-keys" title="Permalink to this headline">¶</a></h3>
<p>Set up SSH keys to avoid typing your password all the time:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ssh-keygen -t rsa -b <span class="m">4096</span>
</pre></div>
</div>
<p>Hit enter when it asks you to. Don’t create a passphrase, that really defeats the point.</p>
<p>To copy your details to other places, type:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ssh-copy-id username@destination
</pre></div>
</div>
<p>You can set up your <code class="docutils literal notranslate"><span class="pre">.ssh/config</span></code> file to avoid specifying usernames, IP addresses for hosts, etc. Have a look on the shared drive in <code class="docutils literal notranslate"><span class="pre">SHARED/ssh_config</span></code> for details, or just copy that file to <code class="docutils literal notranslate"><span class="pre">~/.ssh/config</span></code>.</p>
</div>
</div>
<div class="section" id="store">
<h2>Store<a class="headerlink" href="#store" title="Permalink to this headline">¶</a></h2>
<p>On the computers with SSDs and HDDs, we call our HDDs <code class="docutils literal notranslate"><span class="pre">/store</span></code>. For now, we have been making a directory called <code class="docutils literal notranslate"><span class="pre">/store</span></code> on the computers without SSDs to maintain consistency. It’s important that all users can read, write, and execute files in <code class="docutils literal notranslate"><span class="pre">/store</span></code>.</p>
<p>On a new computer, your HDD will likely not be mounted at <code class="docutils literal notranslate"><span class="pre">/store</span></code> automatically. Search (by hitting the windows button) for <span class="menuselection">Disks</span>. On the 2.0TB hard disk entry, click the gears button to bring up a menu of actions. Choose <span class="menuselection">Edit Mount Options…</span>, turn off <span class="menuselection">User Session Defaults</span>, and change the <span class="menuselection">Mount Point</span> to <code class="docutils literal notranslate"><span class="pre">/store</span></code>.</p>
<p>Generally in <code class="docutils literal notranslate"><span class="pre">/store</span></code> there is an <code class="docutils literal notranslate"><span class="pre">opt/</span></code> directory, where programs are installed, and a <code class="docutils literal notranslate"><span class="pre">src/</span></code> directory, where the source code is. However, due to natural human disorganisation, it is likely to be missing one folder or another, or to have <code class="docutils literal notranslate"><span class="pre">packages/</span></code> and <code class="docutils literal notranslate"><span class="pre">modules/</span></code> directories (see below), or for programs to just be installed willy-nilly. Nonetheless for the sake of the future, it’s best to choose one scheme and stick to it (I recommend the module system).</p>
</div>
<div class="section" id="checkinstall">
<h2>Checkinstall<a class="headerlink" href="#checkinstall" title="Permalink to this headline">¶</a></h2>
<p>We go now into installing things. Here is where I recommend <code class="docutils literal notranslate"><span class="pre">checkinstall</span></code>. This replaces <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">install</span></code> in building packages. It builds a portable <code class="docutils literal notranslate"><span class="pre">.deb</span></code> package that can be installed on other computers with <code class="docutils literal notranslate"><span class="pre">dpkg</span> <span class="pre">-i</span> <span class="pre">my_package.deb</span></code>, and it can be easily removed with <code class="docutils literal notranslate"><span class="pre">dpkg</span> <span class="pre">-r</span> <span class="pre">my_package</span></code>. This solves problems with trying to remove packages when you can’t remember where they have installed files, e.g. when <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">uninstall</span></code> is not a possibility.</p>
<p>You should have installed <code class="docutils literal notranslate"><span class="pre">checkinstall</span></code> earlier, but if not:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo apt install checkinstall
</pre></div>
</div>
<p>As noted, <code class="docutils literal notranslate"><span class="pre">sudo</span> <span class="pre">checkinstall</span></code> replaces <code class="docutils literal notranslate"><span class="pre">sudo</span> <span class="pre">make</span> <span class="pre">install</span></code> in the installation process. It will bring up a menu of options to create the new package. The ‘name’ of the package is always the folder that it’s building from – for instance, GROMACS always has a default name of <code class="docutils literal notranslate"><span class="pre">build</span></code>. Type the number next to the option to change it.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Do not name your package a default name that can be found when running <code class="docutils literal notranslate"><span class="pre">sudo</span> <span class="pre">apt</span> <span class="pre">install</span> <span class="pre">mypackagename</span></code>. Otherwise, it is likely to get replaced by whatever is in the apt repository. e.g. GROMACS 2018.3 should always be called <code class="docutils literal notranslate"><span class="pre">gromacs-2018.3</span></code>, not <code class="docutils literal notranslate"><span class="pre">gromacs</span></code>.</p>
</div>
</div>
<div class="section" id="shared-bashrcs">
<h2>Shared .bashrcs<a class="headerlink" href="#shared-bashrcs" title="Permalink to this headline">¶</a></h2>
<p>This might be awful practice, but I get tired of getting everyone to source the right stuff. Usually at this point I make a <code class="docutils literal notranslate"><span class="pre">shared/</span></code> folder in <code class="docutils literal notranslate"><span class="pre">/home</span></code> with <code class="docutils literal notranslate"><span class="pre">.bashrc</span></code>, <code class="docutils literal notranslate"><span class="pre">.bash_aliases</span></code>, and other useful files. I then edit <code class="docutils literal notranslate"><span class="pre">/etc/skel/.bashrc</span></code> and place these lines at the end:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="o">[</span> -f /home/shared/.bashrc <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
    . /home/shared/.bashrc
<span class="k">fi</span>

<span class="k">if</span> <span class="o">[</span> -f /home/shared/.bash_aliases <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
    . /home/shared/.bash_aliases
<span class="k">fi</span>
</pre></div>
</div>
<p>The computer uses the skeleton files in <code class="docutils literal notranslate"><span class="pre">/etc/skel/</span></code> to populate the home directory of a new user. This way they all source the same files, so they have relatively the same environment, and when you update something it gets propagated to all accounts.</p>
</div>
<div class="section" id="environment-modules">
<h2>Environment modules<a class="headerlink" href="#environment-modules" title="Permalink to this headline">¶</a></h2>
<p>On shared computers, and possibly your own, it’s a good idea to use Environment Modules. These let you switch between package versions with <code class="docutils literal notranslate"><span class="pre">module</span> <span class="pre">load</span></code> and <code class="docutils literal notranslate"><span class="pre">module</span> <span class="pre">unload</span></code>. It’s also a good way to organise and keep track of where things are installed, as modulefiles contain paths.</p>
<div class="section" id="installation">
<h3>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h3>
<p>Install dependencies:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo apt install tcl tcl8.6-dev
</pre></div>
</div>
<p>Make folders to store modulefiles and packages. Typically we put these on <code class="docutils literal notranslate"><span class="pre">/store</span></code>.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mkdir /store/modules /store/packages
</pre></div>
</div>
<p>Download and unzip the latest <cite>Environment modules &lt;http://modules.sourceforge.net/&gt;</cite>. Here, it’s 4.2.3. Navigate to the directory. Set up the build, make, and checkinstall it.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span> modules-4.2.3
./configure
make
sudo checkinstall
</pre></div>
</div>
<p>If <code class="docutils literal notranslate"><span class="pre">/etc/profile.d/modules.sh</span></code> and <code class="docutils literal notranslate"><span class="pre">/etc/profile.d/modules.csh</span></code> already exist, skip this step. Otherwise, copy or symlink them.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo ln -s /usr/local/Modules/init/profile.sh /etc/profile.d/modules.sh
sudo ln -s /usr/local/Modules/init/profile.csh /etc/profile.d/modules.csh
</pre></div>
</div>
<p>Note that the default path for modulefiles is <code class="docutils literal notranslate"><span class="pre">/usr/local/Modules/modulefiles</span></code>. Edit <code class="docutils literal notranslate"><span class="pre">/usr/local/Modules/init/modulerc</span></code> and add <code class="docutils literal notranslate"><span class="pre">module</span> <span class="pre">use</span> <span class="pre">/store/modules</span></code> to use the directory you made above.</p>
<p>From now on, install packages into <code class="docutils literal notranslate"><span class="pre">/store/packages</span></code>.</p>
</div>
<div class="section" id="sourcing-modules">
<h3>Sourcing modules<a class="headerlink" href="#sourcing-modules" title="Permalink to this headline">¶</a></h3>
<p>You need to place the following either into your <code class="docutils literal notranslate"><span class="pre">.bashrc</span></code>, or a shared <code class="docutils literal notranslate"><span class="pre">.bashrc</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="o">[</span> -f /usr/local/Modules/init/bash <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
    . /usr/local/Modules/init/bash
<span class="k">fi</span>
</pre></div>
</div>
</div>
<div class="section" id="modulefiles">
<h3>Modulefiles<a class="headerlink" href="#modulefiles" title="Permalink to this headline">¶</a></h3>
<p>Module files are provided in this repo. Download them and copy the directory structure and files into <code class="docutils literal notranslate"><span class="pre">/store/modules</span></code>. For example, you should have a <code class="docutils literal notranslate"><span class="pre">gromacs</span></code> folder and a <code class="docutils literal notranslate"><span class="pre">cuda</span></code> folder in <code class="docutils literal notranslate"><span class="pre">/store/modules</span></code>. Depending on how you choose to install those packages, you may have to edit the paths of each file.</p>
</div>
</div>
<div class="section" id="anaconda">
<h2>Anaconda<a class="headerlink" href="#anaconda" title="Permalink to this headline">¶</a></h2>
<p>It is a very good idea to download and install Anaconda before doing anyting else with Python. Conda allows you to separate packages into isolated Python environments, and handles package dependencies for you. Create a new environment with:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>conda create --name myenv <span class="o">[</span><span class="nv">python</span><span class="o">=</span><span class="m">3</span>.6<span class="o">]</span> <span class="o">[</span><span class="nv">scipy</span><span class="o">=</span><span class="m">0</span>.15.0<span class="o">]</span>
</pre></div>
</div>
</div>
<div class="section" id="gcc">
<span id="install-gcc-label"></span><h2>GCC<a class="headerlink" href="#gcc" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id1">
<h3>Installation<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>We often need multiple versions of GCC to compile older packages. Versions 6+ can be installed with <code class="docutils literal notranslate"><span class="pre">sudo</span> <span class="pre">apt</span></code>.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo apt install gcc-6 g++-6 gcc-7 g++-7 gcc-8 g++-8
</pre></div>
</div>
<p>If you wish to install <a class="reference internal" href="#install-gromacs-label"><span class="std std-ref">GROMACS 2016.1</span></a>, you will need <a class="reference internal" href="#install-cuda-label"><span class="std std-ref">CUDA 8.0</span></a>. This in turn requires GCC 5.4, which needs to be installed manually.</p>
<p>GCC 5.4 is a bit broken. We have a patched package on our shared drive, complete with built <code class="docutils literal notranslate"><span class="pre">.deb</span></code>. Note that if you wish to install into <code class="docutils literal notranslate"><span class="pre">/store/opt</span></code>, you can just run <code class="docutils literal notranslate"><span class="pre">dpkg</span> <span class="pre">-i</span>&#160; <span class="pre">gcc-5.4.0_5.4.0-patched-1_amd64.deb</span></code>. Alternatively, copy it and run:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span> gcc-5.4.0
./contrib/download_prerequisites
<span class="nb">cd</span> ..
mkdir objdir <span class="o">&amp;&amp;</span> <span class="nb">cd</span> objdir
<span class="nv">$PWD</span>/../gcc-5.4.0/configure --prefix<span class="o">=</span>/store/opt/gcc-5.4.0 --enable-languages<span class="o">=</span>c,c++,fortran --disable-multilib
make
sudo checkinstall
</pre></div>
</div>
</div>
<div class="section" id="switching-between-versions">
<h3>Switching between versions<a class="headerlink" href="#switching-between-versions" title="Permalink to this headline">¶</a></h3>
<p>At this point you may wish to set up <code class="docutils literal notranslate"><span class="pre">update-alternatives</span></code> for easy switching between compilers.</p>
<p>Clear any options you may already have for gcc and g++.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo update-alternatives --remove-all gcc
sudo update-alternatives --remove-all g++
</pre></div>
</div>
<p>Then configure the program path (second last field, e.g. <code class="docutils literal notranslate"><span class="pre">/store/opt/gcc-5.4.0/bin/gcc</span></code>) to the first field (e.g. <code class="docutils literal notranslate"><span class="pre">/usr/bin/gcc</span></code>). The last number indicates priority. A larger number is higher.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo update-alternatives --install /usr/bin/gcc gcc /store/opt/gcc-5.4.0/bin/gcc <span class="m">10</span>
sudo update-alternatives --install /usr/bin/gcc gcc /usr/bin/gcc-6 <span class="m">20</span>
sudo update-alternatives --install /usr/bin/gcc gcc /usr/bin/gcc-7 <span class="m">30</span>
sudo update-alternatives --install /usr/bin/gcc gcc /usr/bin/gcc-8 <span class="m">40</span>
sudo update-alternatives --install /usr/bin/g++ g++ /store/opt/gcc-5.4.0/bin/g++ <span class="m">10</span>
sudo update-alternatives --install /usr/bin/g++ g++ /usr/bin/g++-6 <span class="m">20</span>
sudo update-alternatives --install /usr/bin/g++ g++ /usr/bin/g++-7 <span class="m">30</span>
sudo update-alternatives --install /usr/bin/g++ g++ /usr/bin/g++-8 <span class="m">40</span>
</pre></div>
</div>
<p>To switch between them, run:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo update-alternatives --config gcc
</pre></div>
</div>
</div>
</div>
<div class="section" id="cuda">
<span id="install-cuda-label"></span><h2>CUDA<a class="headerlink" href="#cuda" title="Permalink to this headline">¶</a></h2>
<div class="section" id="cuda-8">
<h3>CUDA 8<a class="headerlink" href="#cuda-8" title="Permalink to this headline">¶</a></h3>
<p>This is necessary for GROMACS 2016.1.</p>
<p>Make sure you have the patched version of <code class="docutils literal notranslate"><span class="pre">cuda_8.0.61_375.26_linux.run</span></code>. It’s too big to put on the repo, but it is on our shared drive in <code class="docutils literal notranslate"><span class="pre">SHARED/cuda/</span></code>. External users can download the unpatched version and patch it themselves.</p>
<p>Unpack and copy <code class="docutils literal notranslate"><span class="pre">InstallUtils.pm</span></code> to your computer. Then install the toolkit.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>/cuda_8.0.61_375.25_linux.run --tar mxvf
sudo cp InstallUtils.pm /usr/lib/x86_64-linux-gnu/perl-base
<span class="nb">export</span> <span class="nv">$PERL5LIB</span>
sudo sh cuda_8.0.61_375.25_linux.run --toolkit --toolkitpath<span class="o">=</span>/store/packages/cuda/cuda-8.0 --silent
</pre></div>
</div>
<p>Check that <code class="docutils literal notranslate"><span class="pre">/store/packages/cuda/cuda-8.0/bin/nvcc</span></code> exists.</p>
</div>
<div class="section" id="cuda-9">
<h3>CUDA 9<a class="headerlink" href="#cuda-9" title="Permalink to this headline">¶</a></h3>
<p>This is necessary for AMBER 16.</p>
<p>Make sure you have gcc-6 selected with:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo update-alternatives --config gcc
</pre></div>
</div>
<p>This doesn’t work when you try to install it non-interactively, for some reason.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo sh cuda_9.0.176_384.81_linux.run
</pre></div>
</div>
<p><kbd class="kbd docutils literal notranslate">ctrl+C</kbd> to scroll to the end of the terms and conditions. Accept and pass in your path you want to install to, when prompted. (Likely <code class="docutils literal notranslate"><span class="pre">/store/packages/cuda/cuda-9.0</span></code>.)</p>
</div>
<div class="section" id="cuda-10">
<h3>CUDA 10<a class="headerlink" href="#cuda-10" title="Permalink to this headline">¶</a></h3>
<p>This shouldn’t need the extra copying and exporting, I think.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo sh cuda_10.1.105_418.39_linux.run --toolkit --toolkitpath<span class="o">=</span>/store/packages/cuda/cuda-10.1 --silent
</pre></div>
</div>
</div>
</div>
<div class="section" id="gromacs">
<span id="install-gromacs-label"></span><h2>GROMACS<a class="headerlink" href="#gromacs" title="Permalink to this headline">¶</a></h2>
<p>You need <code class="docutils literal notranslate"><span class="pre">cmake</span></code> for this.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo apt install cmake
</pre></div>
</div>
<div class="section" id="id2">
<h3>2016.1<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<p>Make sure you have GCC 5.4 running with <code class="docutils literal notranslate"><span class="pre">gcc</span> <span class="pre">--version</span></code>. If it’s another version, change it with <code class="docutils literal notranslate"><span class="pre">sudo</span> <span class="pre">update-alternatives</span> <span class="pre">--config</span> <span class="pre">gcc</span></code>.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>tar xfz gromacs-2016.1.tar.gz
<span class="nb">cd</span> gromacs-2016.1
mkdir build <span class="o">&amp;&amp;</span> <span class="nb">cd</span> build
cmake .. -DGMX_BUILD_OWN_FFTW<span class="o">=</span>ON -DREGRESSIONTEST_DOWNLOAD<span class="o">=</span>ON <span class="se">\</span>
-DGMX_GPU<span class="o">=</span>on -DCMAKE_INSTALL_PREFIX<span class="o">=</span>/store/packages/gromacs/gromacs-2016.1 <span class="se">\</span>
-DCMAKE_CXX_FLAGS<span class="o">=</span>-fPIC -DCUDA_TOOLKIT_ROOT_DIR<span class="o">=</span>/store/packages/cuda/cuda-8.0
make -j <span class="m">6</span>
make check
sudo checkinstall
</pre></div>
</div>
</div>
<div class="section" id="id3">
<h3>2018.3<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<p>I think this works fine with CUDA 10 and GCC 8.3.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>tar xfz gromacs-2018.3.tar.gz
<span class="nb">cd</span> gromacs-2018.3
mkdir build <span class="o">&amp;&amp;</span> <span class="nb">cd</span> build
cmake .. -DGMX_BUILD_OWN_FFTW<span class="o">=</span>ON -DREGRESSIONTEST_DOWNLOAD<span class="o">=</span>ON <span class="se">\</span>
-DGMX_GPU<span class="o">=</span>on -DCMAKE_INSTALL_PREFIX<span class="o">=</span>/store/packages/gromacs/gromacs-2018.3 <span class="se">\</span>
-DCMAKE_CXX_FLAGS<span class="o">=</span>-fPIC -DCUDA_TOOLKIT_ROOT_DIR<span class="o">=</span>/store/packages/cuda/cuda-10.1
make -j <span class="m">6</span>
make check
sudo checkinstall
</pre></div>
</div>
</div>
<div class="section" id="other-versions">
<h3>Other versions<a class="headerlink" href="#other-versions" title="Permalink to this headline">¶</a></h3>
<p>Other versions will have largely the same commands. Remember to check which CUDA and GCC versions they should have.</p>
</div>
<div class="section" id="g-mydensity-4-5-7">
<h3>g_mydensity (4.5.7)<a class="headerlink" href="#g-mydensity-4-5-7" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="http://perso.ibcp.fr/luca.monticelli/tools/index.html">g_mydensity</a> is a great tool with an extremely specific required environment. While it seems to have previously compiled with GROMACS 5.1.4, that may have been a fever dream because it definitely didn’t in 2019. The program is tested against GROMACS 4.5.x; we compiled 4.5.7 for this. GROMACS 4.5.7 requires <code class="docutils literal notranslate"><span class="pre">fftw-3</span></code>.</p>
<p>Start by setting your compiler flags with <code class="docutils literal notranslate"><span class="pre">-fPIC</span></code>.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span> <span class="nv">CXXFLAGS</span><span class="o">=</span>-fPIC
<span class="nb">export</span> <span class="nv">CFLAGS</span><span class="o">=</span>-fPIC
</pre></div>
</div>
<div class="section" id="install-fftw-3">
<h4>Install fftw-3<a class="headerlink" href="#install-fftw-3" title="Permalink to this headline">¶</a></h4>
<p>We downloaded <a class="reference external" href="http://www.fftw.org/download.html">FFTE 3.3.8</a>.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>tar xvf fftw-3.3.8.tar
<span class="nb">cd</span> fftw-3.3.8
./configure --enable-threads --enable-float
make -j <span class="m">12</span>
sudo checkinstall
</pre></div>
</div>
<p>If something goes wrong here, enable fPIC, run <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">clean</span></code>, and try again.</p>
</div>
<div class="section" id="gromacs-4-5-7">
<h4>GROMACS 4.5.7<a class="headerlink" href="#gromacs-4-5-7" title="Permalink to this headline">¶</a></h4>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span> gromacs-4.5.7/
mkdir build <span class="o">&amp;&amp;</span> <span class="nb">cd</span> build
cmake .. -DCMAKE_INSTALL_PREFIX<span class="o">=</span>/store/packages/gromacs/gromacs-4.5.7
make -j <span class="m">12</span>
make <span class="nb">test</span>
sudo checkinstall
</pre></div>
</div>
</div>
<div class="section" id="id4">
<h4>g_mydensity<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h4>
<p>We downloaded ours from <a class="reference external" href="http://perso.ibcp.fr/luca.monticelli/tools/index.html">Luca Monticelli’s website</a>. You must source GROMACS 4.5.7 for this to compile. We have chosen to symlink it to <code class="docutils literal notranslate"><span class="pre">/usr/local/bin</span></code>.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>module load gromacs/4.5.7
mv jbarnoud-g_mydensity-4f9a93c151a9 g_mydensity <span class="o">&amp;&amp;</span> <span class="nb">cd</span> g_mydensity
make
sudo chmod a+x g_mydensity
sudo ln -s /store/opt/g_mydensity/g_mydensity /usr/local/bin/g_mydensity
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="amber">
<span id="install-amber-label"></span><h2>AMBER<a class="headerlink" href="#amber" title="Permalink to this headline">¶</a></h2>
<div class="section" id="ambertools-19">
<h3>AmberTools 19<a class="headerlink" href="#ambertools-19" title="Permalink to this headline">¶</a></h3>
<p>This requires gcc 8 and cuda 10. Install dependencies:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo apt-get install bc csh flex gfortran g++ xorg-dev zlib1g-dev
sudo apt-get install flex bison libbz2-dev patch
</pre></div>
</div>
<p>Download and untar AMBER:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>tar xvfj AmberTools19.tar.bz2  <span class="c1"># should create an amber18 folder</span>
mv amber18 /store/packages/amber/
<span class="nb">cd</span> /store/packages/amber/amber18
</pre></div>
</div>
<p>Set up your environment:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span> <span class="nv">AMBERHOME</span><span class="o">=</span>/store/packages/amber/amber18/
<span class="nb">export</span> <span class="nv">CUDA_HOME</span><span class="o">=</span>/store/packages/cuda/cuda-10.0/
</pre></div>
</div>
<p>Configure and install:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>./configure gnu
<span class="nb">source</span> /store/packages/amber/amber18/amber.sh
sudo checkinstall
</pre></div>
</div>
</div>
<div class="section" id="amber-16">
<h3>Amber 16<a class="headerlink" href="#amber-16" title="Permalink to this headline">¶</a></h3>
<div class="section" id="cuda-and-gfortran">
<h4>CUDA and gfortran<a class="headerlink" href="#cuda-and-gfortran" title="Permalink to this headline">¶</a></h4>
<p>This requires CUDA 9.0, which requires gcc 6. It also requires g++ 6 and gfortran 6. If you’ve upgraded to Eoan Ermine (19.10), you won’t have this available as a package. Edit <code class="docutils literal notranslate"><span class="pre">/etc/apt/sources.list</span></code> and add the following lines to the bottom of the file.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>deb http://us.archive.ubuntu.com/ubuntu/ disco universe
<span class="c1"># deb-src http://us.archive.ubuntu.com/ubuntu/ disco universe</span>
</pre></div>
</div>
<p>Save it and run <code class="docutils literal notranslate"><span class="pre">sudo</span> <span class="pre">apt</span> <span class="pre">update</span></code>. Install gfortran with <code class="docutils literal notranslate"><span class="pre">sudo</span> <span class="pre">apt</span> <span class="pre">install</span> <span class="pre">gfortran-6</span> <span class="pre">gfortran-7</span> <span class="pre">gfortran-8</span></code>, and configure with <code class="docutils literal notranslate"><span class="pre">update-alternatives</span></code>.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo update-alternatives --remove-all gfortran
sudo update-alternatives --install /usr/bin/gfortran gfortran /usr/bin/gfortran-6 <span class="m">20</span>
sudo update-alternatives --install /usr/bin/gfortran gfortran /usr/bin/gfortran-7 <span class="m">30</span>
sudo update-alternatives --install /usr/bin/gfortran gfortran /usr/bin/gfortran-8 <span class="m">40</span>
</pre></div>
</div>
</div>
<div class="section" id="dependencies">
<h4>Dependencies<a class="headerlink" href="#dependencies" title="Permalink to this headline">¶</a></h4>
<p>Use the version with netcdf already present. We have a working copy on iodine. Move it to <code class="docutils literal notranslate"><span class="pre">/store/packages/amber/amber16/</span></code>.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span> <span class="nv">AMBERHOME</span><span class="o">=</span>/store/packages/amber/amber16/
<span class="nb">export</span> <span class="nv">CUDA_HOME</span><span class="o">=</span>/store/packages/cuda/cuda-9.0/
sudo apt install python-tk python-matplotlib  <span class="c1"># other packages should be installed with AmberTools above</span>
</pre></div>
</div>
</div>
<div class="section" id="install">
<h4>Install<a class="headerlink" href="#install" title="Permalink to this headline">¶</a></h4>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span> <span class="nv">$AMBERHOME</span>
./configure -cuda gnu
<span class="nb">source</span> /store/packages/amber/amber16/amber.sh
<span class="nb">export</span> <span class="nv">LD_LIBRARY_PATH</span><span class="o">=</span><span class="s2">&quot;/store/packages/cuda/cuda-9.0/lib64:</span><span class="si">${</span><span class="nv">LD_LIBRARY_PATH</span><span class="si">}</span><span class="s2">&quot;</span>
make -j <span class="m">12</span>
sudo -E checkinstall
make <span class="nb">test</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you get an error message with <code class="docutils literal notranslate"><span class="pre">cudaGetDeviceCount</span> <span class="pre">failed</span> <span class="pre">unknown</span></code>, install this package:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo apt install nvidia-modprobe
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="autodock-tools-and-vina">
<h2>Autodock Tools and Vina<a class="headerlink" href="#autodock-tools-and-vina" title="Permalink to this headline">¶</a></h2>
<p>We downloaded the <a class="reference external" href="http://mgltools.scripps.edu/downloads">MGLTools script</a> from the site.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mv mgltools_Linux-x86_64_1.5.6_Install /store/opt
chmod a+x mgltools_Linux-x86_64_1.5.6_Install
./mgltools_Linux-x86_64_1.5.6_Install
sudo ln -s /store/opt/MGLTools-1.5.6/bin/adt /usr/local/bin/adt
</pre></div>
</div>
<p>For Autodock Vina:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo apt install autodock-vina
</pre></div>
</div>
</div>
<div class="section" id="pymol">
<h2>PyMol<a class="headerlink" href="#pymol" title="Permalink to this headline">¶</a></h2>
<div class="section" id="apt">
<h3>apt<a class="headerlink" href="#apt" title="Permalink to this headline">¶</a></h3>
<p>The quickest way to get the open-source version is probably to use <code class="docutils literal notranslate"><span class="pre">apt</span></code>.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo apt install pymol
</pre></div>
</div>
<p>However, this will clash with conda. Deactivate conda with <code class="docutils literal notranslate"><span class="pre">conda</span> <span class="pre">deactivate</span></code> to run PyMol.</p>
</div>
<div class="section" id="building-from-source">
<h3>Building from source<a class="headerlink" href="#building-from-source" title="Permalink to this headline">¶</a></h3>
<p>Alternatively, build it from source.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git clone https://github.com/schrodinger/pymol-open-source
<span class="nb">cd</span> pymol-open-source
python setup.py install --prefix<span class="o">=</span>/store/packages/pymol/pymol-open-source
</pre></div>
</div>
<p>And update your path.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">echo</span> <span class="s1">&#39;PATH=/store/packages/pymol/pymol-open-source/bin:$PATH&#39;</span> &gt;&gt; /home/shared/.bashrc
</pre></div>
</div>
<p>(If you’re not root, replace <code class="docutils literal notranslate"><span class="pre">/home/shared.bashrc</span></code> with <code class="docutils literal notranslate"><span class="pre">~/.bashrc</span></code>.)</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="rest.html" class="btn btn-neutral float-right" title="How to edit these docs" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral float-left" title="Set-ups, shell environments, installations" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Lily Wang, Katie Wilson, Hugo MacDermott-Opeskin, Megan O&#39;Mara

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>